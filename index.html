<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BMG Foundation</title>

  <!-- Firebase SDKs (CDN) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>

  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body, html{font-family: Arial, sans-serif; background:#f4f4f4;}
    .top-menu{
      position:fixed; top:0; left:0; width:100%; background:#007bff; color:white;
      display:flex; justify-content:center; align-items:center; padding:10px; z-index:1000;
    }
    .menu-btn{
      background:#0056b3; color:white; border:none; padding:10px 20px; margin:0 5px; border-radius:5px; cursor:pointer;
      position:relative; font-size:16px;
    }
    .menu-btn:hover{background:#004494;}
    .admin-btn{background:#28a745;}
    .admin-btn:hover{background:#218838;}
    .dropdown{
      display:none; position:absolute; top:10%; left:0; background:white; color:black;
      min-width:10px; border-radius:5px; box-shadow:0 2px 5px rgba(0,0,0,0.3); transition:all 0.2s;
    }
    .dropdown .dropdown-item{
      padding:12px; cursor:pointer; border-bottom:1px solid #eee;
    }
    .dropdown .dropdown-item:last-child{border-bottom:none;}
    .dropdown .dropdown-item:hover{background:#f4f4f4;}
    .hero{
      margin-top:70px;
      height:70vh;
      background: url('kabristan1.jpg') no-repeat center center;
      background-size:cover;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      color:white; text-align:center;
    }
    .hero h1{font-size:2.2em; margin-bottom:10px; font-weight:bold;}
    .hero p{font-size:1.2em; text-shadow:2px 2px 8px rgba(0,0,0,0.4);}
    .modal{
      display:none; position:fixed; z-index:1001; left:0; top:0; width:100%; height:100%;
      background:rgba(0,0,0,0.5);
    }
    .modal-content{
      background:#fff; border-radius:10px; margin:5% auto; padding:20px; max-width:700px; position:relative;
      min-height:100px; box-shadow: 1px 1px 20px #22222220;
    }
    .close{
      position:absolute; top:10px; right:15px; font-size:28px; color:red; cursor:pointer;
    }
    .close:hover{color:black;}
    input, select, button{padding:8px; margin-top:4px; width:100%; border-radius:5px; border:1px solid #bbb; box-sizing:border-box;}
    button.save-btn, button.login-btn{background:#007bff;color:white;border:none;cursor:pointer;}
    button.save-btn:hover, button.login-btn:hover{background:#0056b3;}
    .logout-btn{background:#dc3545; color:white; border:none; padding:10px; border-radius:5px; cursor:pointer; margin:10px;}
    .logout-btn:hover{background:#c82333;}
    table{width:100%; border-collapse:collapse; margin-top:10px;}
    th, td{border:1px solid #ccc; padding:8px 4px; text-align:center;}
    #searchDonor{margin-bottom:10px;}
    .admin-section{display:none;}
    @media(max-width:600px){
      .top-menu{flex-direction:column;}
      .menu-btn{width:90vw;margin:4px 0;}
      .modal-content{max-width:97vw;}
    }
  </style>
</head>
<body>

  <!-- Top Menu -->
  <div class="top-menu">
    <div class="menu-btn" onclick="toggleDropdown(event,'donateDropdown')">Donate
      <div class="dropdown" id="donateDropdown">
        <div class="dropdown-item" onclick="showSection('donateSection')">Payment Info / QR Code</div>
      </div>
    </div>
    <div class="menu-btn" onclick="toggleDropdown(event,'donorDropdown')">Donor List
      <div class="dropdown" id="donorDropdown">
        <div class="dropdown-item" onclick="showSection('donorSection')">View Donors</div>
      </div>
    </div>
    <div class="menu-btn" onclick="toggleDropdown(event,'pdfDropdown')">PDF
      <div class="dropdown" id="pdfDropdown">
        <div class="dropdown-item" onclick="showSection('pdfSection')">Old Donor PDF</div>
      </div>
    </div>
    <div class="menu-btn" onclick="toggleDropdown(event,'workDropdown')">Work & Pay
      <div class="dropdown" id="workDropdown">
        <div class="dropdown-item" onclick="showSection('viewWorkSection')">View Work & Pay</div>
      </div>
    </div>
    <div class="menu-btn" onclick="toggleDropdown(event,'labourDropdown')">Labour Charge
      <div class="dropdown" id="labourDropdown">
        <div class="dropdown-item" onclick="showSection('viewLabourSection')">View Labour Charge</div>
      </div>
    </div>
    <div class="menu-btn admin-btn" id="adminBtn" onclick="toggleDropdown(event,'adminDropdown')" style="display:none;">Admin Panel
      <div class="dropdown" id="adminDropdown">
        <div class="dropdown-item" onclick="showSection('addDonorSection')">Add Donor</div>
        <div class="dropdown-item" onclick="showSection('addWorkSection')">Add Work & Pay</div>
        <div class="dropdown-item" onclick="showSection('addLabourSection')">Add Labour Charge</div>
      </div>
    </div>
    <div class="menu-btn" onclick="showSection('loginSection')" id="loginBtn">Login</div>
    <button class="logout-btn" id="logoutBtn" onclick="logout()" style="display:none;">Logout</button>
  </div>

  <!-- Hero -->
  <section class="hero">
    <h1>Bargachhiya Gaon ki Muslim Community</h1>
    <p>Masjid, Madrasa aur Kabristan</p>
  </section>

  <!-- Modal Box -->
  <div id="modal" class="modal" onclick="backdropClick(event)">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>

      <!-- Login Section -->
      <div id="loginSection" style="display:none;">
        <h2>üîê Admin Login</h2>
        <input type="email" id="loginEmail" placeholder="Email (admin@bmg.com)">
        <input type="password" id="loginPassword" placeholder="Password (password123)">
        <button class="login-btn" onclick="login()">Login</button>
      </div>

      <div id="donateSection" style="display:none;">
        <h2>üí≥ Payment Info</h2>
        <p>Bank: India Post Payments Bank</p>
        <p>Account No: <b>009910338952</b></p>
        <p>IFSC: <b>IPOS0000001</b></p>
        <p>UPI ID: <b>7050859156@axl</b></p>
        <p><img src="Bmg scanner.jpg" alt="QR Code" style="width:180px; border-radius:8px;"></p>
      </div>

      <div id="donorSection" style="display:none;">
        <h2>üìÑ Donor List</h2>
        <input type="text" id="searchDonor" placeholder="Search name..." onkeyup="searchDonor()">
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Amount</th>
              <th>Location</th>
              <th>Payment Method</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody id="donorList"></tbody>
        </table>
      </div>

      <div id="pdfSection" style="display:none;">
        <h2>üìÑ Old Donor PDF</h2>
        <a href=" old_donor_report.pdf" target="_blank">View PDF</a>
      </div>

      <div id="viewWorkSection" style="display:none;">
        <h2>üìã View Work & Pay</h2>
        <table>
          <thead>
            <tr>
              <th>Description</th>
              <th>Amount</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody id="workList"></tbody>
        </table>
      </div>

      <div id="viewLabourSection" style="display:none;">
        <h2>üí∞ View Labour Charge</h2>
        <table>
          <thead>
            <tr>
              <th>Labour Name</th>
              <th>Charge</th>
              <th>Work Type</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody id="labourList"></tbody>
        </table>
      </div>

      <!-- Admin Sections -->
      <div id="addDonorSection" class="admin-section" style="display:none;">
        <h3>‚ú® Add New Donor</h3>
        <input type="text" id="donorName" placeholder="Donor Name">
        <input type="number" id="donorAmount" min="1" placeholder="Amount">
        <input type="text" id="donorLocation" placeholder="Location">
        <select id="paymentMethod">
          <option value="UPI">UPI</option>
          <option value="Bank">Bank</option>
        </select>
        <button class="save-btn" onclick="addDonor()">Save Donor</button>
      </div>

      <div id="addWorkSection" class="admin-section" style="display:none;">
        <h3>‚öôÔ∏è Add Work & Pay</h3>
        <input type="text" id="workDescription" placeholder="Work Description">
        <input type="number" id="workAmount" min="1" placeholder="Payment Amount">
        <input type="date" id="workDate">
        <button class="save-btn" onclick="addWork()">Save Work</button>
      </div>

      <div id="addLabourSection" class="admin-section" style="display:none;">
        <h3>üë∑ Add Labour Charge</h3>
        <input type="text" id="labourName" placeholder="Labour Name">
        <input type="number" id="labourCharge" min="1" placeholder="Charge Amount">
        <input type="text" id="labourWork" placeholder="Work Type">
        <input type="date" id="labourDate">
        <button class="save-btn" onclick="addLabour()">Save Labour</button>
      </div>
    </div>
  </div>

  <!-- Contact Section -->
  <section id="contact" style="padding:50px; background:#f9f9f9; text-align:center;">
    <h2>üì¨ Contact Us</h2>
    <p>Aap apna message bhej sakte hain, hume turant email mil jayega.</p>
    <form action="https://formspree.io/f/mnngdgze" method="POST" style="max-width:500px; margin:0 auto;">
      <input type="text" name="name" placeholder="üë§ Your Name" required>
      <input type="email" name="_replyto" placeholder="üìß Your Email" required>
      <textarea name="message" placeholder="üí¨ Your Message" required></textarea>
      <button type="submit">üì© Send Message</button>
    </form>
  </section>

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyDXo5T9IszbjGdDlIwpevZG2ODkf69PfJc",
      authDomain: "bmgfoundation.firebaseapp.com",
      projectId: "bmgfoundation",
      storageBucket: "bmgfoundation.firebasestorage.app",
      messagingSenderId: "887483767367",
      appId: "1:887483767367:web:7fda6c64e035a1c2f8ef62",
      measurementId: "G-24JKRK0CDP"
    };
    const app = firebase.initializeApp(firebaseConfig);
    const analytics = firebase.analytics();
    const db = firebase.firestore();
    const auth = firebase.auth();

    let user = null;

    // Auth State Listener
    auth.onAuthStateChanged((u) => {
      user = u;
      if (user) {
        document.getElementById('adminBtn').style.display = 'block';
        document.getElementById('logoutBtn').style.display = 'block';
        document.getElementById('loginBtn').style.display = 'none';
      } else {
        document.getElementById('adminBtn').style.display = 'none';
        document.getElementById('logoutBtn').style.display = 'none';
        document.getElementById('loginBtn').style.display = 'block';
      }
    });

    // Login Function
    function login() {
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      if (!email || !password) {
        alert('Email aur Password ‡§≠‡§∞‡•á‡§Ç!');
        return;
      }
      auth.signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
          alert('‚úÖ ‡§≤‡•â‡§ó‡§ø‡§® ‡§∏‡§´‡§≤! ‡§Ö‡§¨ Admin Panel ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§');
          closeModal();
        })
        .catch((error) => {
          console.error(error);
          alert('‚ùå ‡§≤‡•â‡§ó‡§ø‡§® ‡§´‡•á‡§≤! Email: admin@bmg.com, Password: password123 ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§');
        });
    }

    // Logout Function
    function logout() {
      auth.signOut().then(() => {
        alert('Logout ‡§∏‡§´‡§≤!');
        closeModal();
      }).catch((error) => {
        console.error(error);
        alert('Logout ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø!');
      });
    }

    // Dropdown & Modal Functions
    function toggleDropdown(e, id) {
      document.querySelectorAll('.dropdown').forEach(d => d.style.display = 'none');
      e.stopPropagation();
      document.getElementById(id).style.display = 'block';
    }
    window.onclick = function() {
      document.querySelectorAll('.dropdown').forEach(d => d.style.display = 'none');
    }
    function closeModal() {
      document.getElementById("modal").style.display = "none";
      hideAll();
    }
    function backdropClick(e) {
      if (e.target.className === 'modal') { closeModal(); }
    }
    function showSection(sectionId) {
      hideAll();
      document.getElementById("modal").style.display = "block";
      document.getElementById(sectionId).style.display = "block";
      if (sectionId === 'donorSection') renderDonors();
      if (sectionId === 'viewWorkSection') renderWorks();
      if (sectionId === 'viewLabourSection') renderLabours();
      if (sectionId.includes('add') && !user) {
        alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç!');
        document.getElementById("modal").style.display = "none";
        document.getElementById("loginSection").style.display = "block";
      }
    }
    function hideAll() {
      const sections = ["donateSection", "donorSection", "pdfSection", "loginSection", "addDonorSection", "addWorkSection", "addLabourSection", "viewWorkSection", "viewLabourSection"];
      sections.forEach(s => document.getElementById(s).style.display = "none");
    }

    // Donor Functions
    function addDonor() {
      if (!user) { alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç!'); showSection('loginSection'); return; }
      const name = document.getElementById("donorName").value.trim();
      const amount = parseInt(document.getElementById("donorAmount").value);
      const location = document.getElementById("donorLocation").value.trim();
      const method = document.getElementById("paymentMethod").value;
      const date = new Date().toLocaleDateString();
      if (!name || !amount) { alert("Name aur Amount required!"); return; }
      db.collection("donors").add({ name, amount, location, method, date, addedBy: user.email })
        .then(() => {
          alert("‚úÖ Donor added!");
          document.getElementById("donorName").value = "";
          document.getElementById("donorAmount").value = "";
          document.getElementById("donorLocation").value = "";
          closeModal();
        })
        .catch(err => { console.error(err); alert("Error adding donor!"); });
    }

    function renderDonors() {
      const list = document.getElementById("donorList");
      list.innerHTML = "<tr><td colspan='5'>‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</td></tr>";
      db.collection("donors").get().then(snapshot => {
        list.innerHTML = "";
        snapshot.forEach(doc => {
          const d = doc.data();
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${d.name}</td><td>${d.amount}</td><td>${d.location}</td><td>${d.method}</td><td>${d.date}</td>`;
          list.appendChild(tr);
        });
      }).catch(err => { console.error(err); alert("‡§°‡•ã‡§®‡§∞ ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø!"); });
    }

    function searchDonor() {
      const query = document.getElementById("searchDonor").value.toLowerCase();
      const list = document.getElementById("donorList");
      list.innerHTML = "";
      db.collection("donors").get().then(snapshot => {
        snapshot.forEach(doc => {
          const d = doc.data();
          if (d.name.toLowerCase().includes(query)) {
            const tr = document.createElement("tr");
            tr.innerHTML = `<td>${d.name}</td><td>${d.amount}</td><td>${d.location}</td><td>${d.method}</td><td>${d.date}</td>`;
            list.appendChild(tr);
          }
        });
      }).catch(err => { console.error(err); alert("‡§°‡•ã‡§®‡§∞ ‡§∏‡§∞‡•ç‡§ö ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø!"); });
    }

    // Work & Pay Functions
    function addWork() {
      if (!user) { alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç!'); showSection('loginSection'); return; }
      const description = document.getElementById("workDescription").value.trim();
      const amount = parseInt(document.getElementById("workAmount").value);
      const date = document.getElementById("workDate").value;
      if (!description || !amount || !date) { alert("‡§∏‡§≠‡•Ä ‡§´‡•Ä‡§≤‡•ç‡§° ‡§≠‡§∞‡•á‡§Ç!"); return; }
      db.collection("works").add({ description, amount, date, addedBy: user.email })
        .then(() => {
          alert("‚úÖ Work added!");
          document.getElementById("workDescription").value = "";
          document.getElementById("workAmount").value = "";
          document.getElementById("workDate").value = "";
          closeModal();
        })
        .catch(err => { console.error(err); alert("Error adding work!"); });
    }

    function renderWorks() {
      const list = document.getElementById("workList");
      list.innerHTML = "<tr><td colspan='3'>‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</td></tr>";
      db.collection("works").get().then(snapshot => {
        list.innerHTML = "";
        snapshot.forEach(doc => {
          const w = doc.data();
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${w.description}</td><td>${w.amount}</td><td>${w.date}</td>`;
          list.appendChild(tr);
        });
      }).catch(err => { console.error(err); alert("Work ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø!"); });
    }

    // Labour Charge Functions
    function addLabour() {
      if (!user) { alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç!'); showSection('loginSection'); return; }
      const name = document.getElementById("labourName").value.trim();
      const charge = parseInt(document.getElementById("labourCharge").value);
      const work = document.getElementById("labourWork").value.trim();
      const date = document.getElementById("labourDate").value;
      if (!name || !charge || !work || !date) { alert("‡§∏‡§≠‡•Ä ‡§´‡•Ä‡§≤‡•ç‡§° ‡§≠‡§∞‡•á‡§Ç!"); return; }
      db.collection("labours").add({ name, charge, work, date, addedBy: user.email })
        .then(() => {
          alert("‚úÖ Labour added!");
          document.getElementById("labourName").value = "";
          document.getElementById("labourCharge").value = "";
          document.getElementById("labourWork").value = "";
          document.getElementById("labourDate").value = "";
          closeModal();
        })
        .catch(err => { console.error(err); alert("Error adding labour!"); });
    }

    function renderLabours() {
      const list = document.getElementById("labourList");
      list.innerHTML = "<tr><td colspan='4'>‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</td></tr>";
      db.collection("labours").get().then(snapshot => {
        list.innerHTML = "";
        snapshot.forEach(doc => {
          const l = doc.data();
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${l.name}</td><td>${l.charge}</td><td>${l.work}</td><td>${l.date}</td>`;
          list.appendChild(tr);
        });
      }).catch(err => { console.error(err); alert("Labour ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø!"); });
    }
  </script>
</body>
</html>0

